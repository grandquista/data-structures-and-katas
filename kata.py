def k_odd(n):
    if n == 1:
        return ''
    if n == 3:
        return '1011101|1010001|1000101|101101|100001|10101|1001|110'
    if n == 5:
        return '1001011|1000001|110111|100011|11001|1111'
    if n == 7:
        return '1011011|1001101|110001|100011|10101'
    if n == 9:
        return '1100011|1010001|111111|101101|11011'
    if n == 11:
        return '1100011|1001101|110111|100001'
    if n == 13:
        return '1011011|1000001|100111'
    if n == 15:
        return '1001011|101101'
    if n == 17:
        return '1010101|110011'
    return '01?:*+^$()[]|'


def k(n):
    if n in (6, 10, 12, 14, 18):
        return f'{ k(n // 2) }0'
    if n % 2 == 0:
        return f'[01]+{ bin(n)[3:] }'
    return f'({ k_odd(n) }|{ bin(n)[2:] }|0)+'


def kata(n):
    return f'^0*(0|({ k(n) }))$'
